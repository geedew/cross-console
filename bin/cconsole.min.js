/*! cross-console 0.2.5 2013-08-27 */
!function(a){"use strict";var b={},c=a||window||this,d=c.console,e=Array.prototype.slice,f=["CC.filter","CC.history"],g=c.localStorage&&c.JSON;d&&(b=Object.create(d)),"undefined"!=typeof module?module.exports=b:c.cconsole=b,b.settings={persistConfig:{filter:f[0],history:f[1]},standBy:!1,timestamp:!0,debug:!0,environment:"development",history:g?JSON.parse(c.localStorage.getItem(f[1]))||[]:[],maxHistory:100,filter:g?c.localStorage.getItem(f[0])||!1:!1,notify:function(){}},b.set=function(a){if("undefined"==typeof a||"object"!=typeof a||a instanceof String||a instanceof Array)throw Error("You must pass an plain object to set settings. EG: { }");for(var c in a)a.hasOwnProperty(c)&&(b.settings[c]=a[c])},b.clearFilter=function(){b.settings.filter=!1,g&&c.localStorage.setItem(b.settings.persistConfig.filter,!1)},b.setFilter=function(a){if("string"!=typeof a&&!(a instanceof String))throw new Error("Filters must be of type string");b.settings.filter=a,g&&c.localStorage.setItem(b.settings.persistConfig.filter,a)};var h=["error","warn","info","debug","log"],i=["assert","clear","count","dir","dirxml","exception","group","groupCollapsed","groupEnd","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","memory","profiles"],j=i.length,k=function(){var a=[];return function(b,c){if(b&&c&&["[object Object]","[object Array]"].indexOf(Object.prototype.toString.call(c))>-1){if(a.indexOf(c)>-1)return"<Circular Reference>";a.push(c)}return c}},l=function(a){b.settings.history.unshift(a),b.settings.history.length>b.settings.maxHistory&&b.settings.history.pop(),g&&c.localStorage.setItem(b.settings.persistConfig.history,c.JSON.stringify(b.settings.history,k()," "))},m=function(a){b[a]=function(){var f=e.call(arguments);try{if(b.settings.standBy)return d.firebug?d[a].apply(c,f):d[a]?d[a].apply(d,f):d.log.apply(d,f),void 0;if("production"===b.settings.environment)return;if(!d||!b.settings.debug||b.settings.filter&&f[0].indexOf(b.settings.filter)<0)return;b.settings.timestamp&&f.unshift((new Date).toISOString()),l([a].concat(f)),d.firebug?d[a].apply(c,f):d[a]?d[a].apply(d,f):d.log.apply(d,f)}catch(g){if(b.settings.debug)throw new Error(g)}}},n=function(a,f){b[f]=function(){var a=e.call(arguments);try{if(b.settings.standBy)return d.firebug?d[f].apply(c,a):d[f]?d[f].apply(d,a):d.log.apply(d,a),void 0;if("error"!==f&&"production"===b.settings.environment)return;var g,h,i,j=new Error,k=j&&j.stack,m="",n=/\//g,o=["error","warn"];if(k&&"string"==typeof k)try{h=k.split(/\r\n|\r|\n/),h=h[h.length-1].split(/\//)}catch(p){h=["Failed to retrieve stack trace."]}if(i=h[h.length-1].split(/:/),"debug"!==f?(a.push(i[0]+" Line "+i[1]),m=i[0].replace(n,"~")+":"+i[1]):a.push((new Error&&(new Error).stack?(new Error).stack:"").split(/\r\n|\r|\n/)),!d||o.indexOf(f)<0&&(!b.settings.debug||b.settings.filter&&a[0].indexOf(b.settings.filter)<0))return;if(b.settings.timestamp&&a.unshift((new Date).toISOString()),g=[f].concat(a),l(g),"production"===b.settings.environment)return b.settings.notify(g,m),void 0;d.firebug?d[f].apply(c,a):d[f]?d[f].apply(d,a):d.log.apply(d,a)}catch(q){if(b.settings.debug)throw new Error(q)}}};for(c.console=b;--j>=0;)m(i[j]);for(j=h.length;--j>=0;)n(j,h[j])}(this);