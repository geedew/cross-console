/*! cross-console 0.3.1 2013-12-10 */
!function(a){"use strict";var b,c,d={},e=a||window||this,f=e.console,g=Array.prototype.slice,h=["CC.filter","CC.history"],i=e.localStorage&&e.JSON;f&&(d=Object.create(f)),"undefined"!=typeof module?module.exports=d:e.cconsole=d,d.settings={persistConfig:{filter:h[0],history:h[1]},persist:i,standBy:!1,timestamp:!0,debug:!1,environment:"production",history:i?JSON.parse(e.localStorage.getItem(h[1]))||[]:[],maxHistory:100,filter:i?JSON.parse(e.localStorage.getItem(h[0]))||!1:!1,notify:function(){}},b=function(a,b){try{setTimeout(function(){e.localStorage.setItem(a,b)},50)}catch(d){c("error",d.message)}},c=function(a,b){return f.firebug?(f[a].apply(e,b),void 0):f[a]&&f[a].apply?(f[a].apply(f,b),void 0):(f.log&&f.log.apply&&f.log.apply(f,b),void 0)},d.set=function(a){if("undefined"==typeof a||"object"!=typeof a||a instanceof String||a instanceof Array)throw Error("You must pass an plain object to set settings. EG: { }");for(var b in a)a.hasOwnProperty(b)&&(d.settings[b]=a[b])},d.clearFilter=function(){d.settings.filter=!1,d.settings.persist&&b(d.settings.persistConfig.filter,!1)},d.setFilter=function(a){if("string"!=typeof a&&!(a instanceof String))throw new Error("Filters must be of type string");d.settings.filter=a,d.settings.persist&&b(d.settings.persistConfig.filter,a)};var j=["error","warn","debug"],k=["log","info","assert","clear","count","dir","dirxml","exception","group","groupCollapsed","groupEnd","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","memory","profiles"],l=k.length,m=function(){var a=[],b=15;return function(c,d){if(b--<1)return"<Depth Restricted>";if(c&&d&&["[object Object]","[object Array]"].indexOf(Object.prototype.toString.call(d))>-1){if(a.indexOf(d)>-1)return"<Circular Reference>";a.push(d)}else if(c&&d&&"[object String]"!==Object.prototype.toString.call(d))return d.toString();return d}},n=function(a){d.settings.history.unshift(a),d.settings.history.length>d.settings.maxHistory&&d.settings.history.pop(),d.settings.persist&&b(d.settings.persistConfig.history,e.JSON.stringify(d.settings.history,m(),""))},o=function(a){d[a]=function(){var b=g.call(arguments);try{if(d.settings.standBy)return c(a,b),void 0;if("production"===d.settings.environment)return;if(!f||!d.settings.debug||d.settings.filter&&b[0].indexOf(d.settings.filter)<0)return;n([a].concat(b)),c(a,b)}catch(e){if(d.settings.debug)throw new Error(e)}}},p=function(a,b){d[b]=function(){var a=g.call(arguments);try{if(d.settings.standBy)return c(b,a),void 0;if("error"!==b&&"production"===d.settings.environment)return;var e,h,i=new Error,j=i&&i.stack,k=[""],l="",m=/\//g,o=["error","warn"];if(j&&"string"==typeof j)try{k=j.split(/\r\n|\r|\n/),k=k[k.length-1].split(/\//)}catch(p){k=["Failed to retrieve stack trace."]}if(h=k[k.length-1].split(/:/),"debug"!==b?(a.push(h[0]+" Line "+h[1]),l=h[0].replace(m,"~")+":"+h[1]):a.push((new Error&&(new Error).stack?(new Error).stack:"").split(/\r\n|\r|\n/)),!f||o.indexOf(b)<0&&(!d.settings.debug||d.settings.filter&&a[0].indexOf(d.settings.filter)<0))return;if(d.settings.timestamp&&a.unshift((new Date).toISOString()),e=[b].concat(a),n(e),"production"===d.settings.environment)return d.settings.notify(e,l),void 0;c(b,a)}catch(q){if(d.settings.debug)throw new Error(q)}}};for(e.console=d;--l>=0;)o(k[l]);for(l=j.length;--l>=0;)f[j[l]]=f[j[l]]||function(){},f[j[l]]=Function.prototype.bind.call(f[j[l]],f),p(l,j[l])}(this);