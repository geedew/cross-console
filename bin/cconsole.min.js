/*! cross-console 0.3.0 2013-10-17 */
!function(a){"use strict";var b,c={},d=a||window||this,e=d.console,f=Array.prototype.slice,g=["CC.filter","CC.history"],h=d.localStorage&&d.JSON;e&&(c=Object.create(e)),"undefined"!=typeof module?module.exports=c:d.cconsole=c,c.settings={persistConfig:{filter:g[0],history:g[1]},persist:h,standBy:!1,timestamp:!0,debug:!1,environment:"production",history:h?JSON.parse(d.localStorage.getItem(g[1]))||[]:[],maxHistory:100,filter:h?JSON.parse(d.localStorage.getItem(g[0]))||!1:!1,notify:function(){}},b=function(a,b){try{d.localStorage.setItem(a,b)}catch(c){}},c.set=function(a){if("undefined"==typeof a||"object"!=typeof a||a instanceof String||a instanceof Array)throw Error("You must pass an plain object to set settings. EG: { }");for(var b in a)a.hasOwnProperty(b)&&(c.settings[b]=a[b])},c.clearFilter=function(){c.settings.filter=!1,c.settings.persist&&b(c.settings.persistConfig.filter,!1)},c.setFilter=function(a){if("string"!=typeof a&&!(a instanceof String))throw new Error("Filters must be of type string");c.settings.filter=a,c.settings.persist&&b(c.settings.persistConfig.filter,a)};var i=["error","warn","debug"],j=["log","info","assert","clear","count","dir","dirxml","exception","group","groupCollapsed","groupEnd","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","memory","profiles"],k=j.length,l=function(){var a=[],b=15;return function(c,d){if(b--<1)return"<Depth Restricted>";if(c&&d&&["[object Object]","[object Array]"].indexOf(Object.prototype.toString.call(d))>-1){if(a.indexOf(d)>-1)return"<Circular Reference>";a.push(d)}else if(c&&d&&"[object String]"!==Object.prototype.toString.call(d))return d.toString();return d}},m=function(a){c.settings.history.unshift(a),c.settings.history.length>c.settings.maxHistory&&c.settings.history.pop(),c.settings.persist&&b(c.settings.persistConfig.history,d.JSON.stringify(c.settings.history,l(),""))},n=function(a){c[a]=function(){var b=f.call(arguments);try{if(c.settings.standBy)return e.firebug?e[a].apply(d,b):e[a]?e[a].apply(e,b):e.log.apply(e,b),void 0;if("production"===c.settings.environment)return;if(!e||!c.settings.debug||c.settings.filter&&b[0].indexOf(c.settings.filter)<0)return;m([a].concat(b)),e.firebug?e[a].apply(d,b):e[a]?e[a].apply(e,b):e.log.apply(e,b)}catch(g){if(c.settings.debug)throw new Error(g)}}},o=function(a,b){c[b]=function(){var a=f.call(arguments);try{if(c.settings.standBy)return e.firebug?e[b].apply(d,a):e[b]?e[b].apply(e,a):e.log.apply(e,a),void 0;if("error"!==b&&"production"===c.settings.environment)return;var g,h,i=new Error,j=i&&i.stack,k=[""],l="",n=/\//g,o=["error","warn"];if(j&&"string"==typeof j)try{k=j.split(/\r\n|\r|\n/),k=k[k.length-1].split(/\//)}catch(p){k=["Failed to retrieve stack trace."]}if(h=k[k.length-1].split(/:/),"debug"!==b?(a.push(h[0]+" Line "+h[1]),l=h[0].replace(n,"~")+":"+h[1]):a.push((new Error&&(new Error).stack?(new Error).stack:"").split(/\r\n|\r|\n/)),!e||o.indexOf(b)<0&&(!c.settings.debug||c.settings.filter&&a[0].indexOf(c.settings.filter)<0))return;if(c.settings.timestamp&&a.unshift((new Date).toISOString()),g=[b].concat(a),m(g),"production"===c.settings.environment)return c.settings.notify(g,l),void 0;e.firebug?e[b].apply(d,a):e[b]?e[b].apply(e,a):e.log.apply(e,a)}catch(q){if(c.settings.debug)throw new Error(q)}}};for(d.console=c;--k>=0;)n(j[k]);for(k=i.length;--k>=0;)e[i[k]]=e[i[k]]||function(){},e[i[k]]=Function.prototype.bind.call(e[i[k]],e),o(k,i[k])}(this);